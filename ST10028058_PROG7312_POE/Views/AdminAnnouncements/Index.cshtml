@model IEnumerable<ST10028058_PROG7312_POE.Models.AnnouncementModel>

@{
    ViewData["Title"] = "Manage Announcements";
}

<div class="container mt-5 mb-5">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-dark mb-0">📢 Manage Announcements</h2>
        <a href="@Url.Action("Create")" class="btn btn-gradient fw-bold text-white px-4 shadow-sm">
            <i class="bi bi-plus-circle me-2"></i>Add Announcement
        </a>
    </div>

    <!-- Filters -->
    <form method="get" class="row g-2 align-items-center mb-4 shadow-sm p-3 rounded-4" style="background:#f8f9fa;">
        <div class="col-md-3">
            <div class="input-group">
                <span class="input-group-text bg-white border-end-0">
                    <i class="bi bi-search text-muted"></i>
                </span>
                <input type="text" name="q" class="form-control border-start-0" placeholder="Search title or message..." value="@ViewBag.Search" />
            </div>
        </div>

        <div class="col-md-2">
            <input type="date" name="fromDate" class="form-control" value="@ViewBag.FromDate" placeholder="From date" />
        </div>

        <div class="col-md-2">
            <input type="date" name="toDate" class="form-control" value="@ViewBag.ToDate" placeholder="To date" />
        </div>

        <div class="col-md-3">
            <select name="author" class="form-select">
                <option value="">All authors</option>
                @foreach (var author in Model.Select(a => a.Author).Distinct())
                {
                    <option value="@author" selected="@(ViewBag.Author == author)">
                        @author
                    </option>
                }
            </select>
        </div>

        <div class="col-md-2 d-flex gap-2">
            <button type="submit" class="btn btn-gradient w-50 fw-bold text-white">Filter</button>
            <a href="@Url.Action("Index", "AdminAnnouncements")" class="btn btn-outline-danger w-50 fw-bold">Reset</a>
        </div>
    </form>

    <!-- Sort Buttons -->
    <div class="d-flex justify-content-end gap-2 mb-3">
        <a href="@Url.Action("Index", new { sortBy = "title", order = ViewBag.SortOrder == "asc" ? "desc" : "asc" })"
           class="btn btn-outline-success fw-semibold">
            <i class="bi bi-sort-alpha-down me-1"></i> Sort by Title
        </a>
        <a href="@Url.Action("Index", new { sortBy = "date", order = ViewBag.SortOrder == "asc" ? "desc" : "asc" })"
           class="btn btn-outline-success fw-semibold">
            <i class="bi bi-sort-down me-1"></i> Sort by Date
        </a>
    </div>

    <!-- Table -->
    @if (!Model.Any())
    {
        <div class="alert alert-info text-center shadow-sm py-3">No announcements found.</div>
    }
    else
    {
        <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
            <div class="card-header text-white py-3" style="background: linear-gradient(90deg, #28a745, #20c997);">
                <h5 class="fw-bold mb-0"><i class="bi bi-megaphone me-2"></i>Announcements</h5>
            </div>
            <div class="card-body bg-light">
                <table class="table table-hover align-middle shadow-sm mb-0 rounded-3 overflow-hidden">
                    <thead class="table-success text-dark">
                        <tr>
                            <th>Title</th>
                            <th>Message</th>
                            <th>Date</th>
                            <th>Author</th>
                            <th class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white">
                        @foreach (var announcement in Model)
                        {
                            <tr class="announcement-row">
                                <td class="fw-semibold">@announcement.Title</td>
                                <td class="text-muted">@announcement.Message</td>
                                <td>@announcement.Date.ToString("yyyy-MM-dd")</td>
                                <td>@announcement.Author</td>
                                <td class="text-center">
                                    <a href="@Url.Action("ViewAnnouncement", new { date = announcement.Date })"
                                       class="btn btn-sm btn-outline-success fw-semibold me-2">
                                        <i class="bi bi-eye me-1"></i>View
                                    </a>
                                    <a href="@Url.Action("Delete", new { date = announcement.Date })"
                                       class="btn btn-sm btn-outline-danger fw-semibold">
                                        <i class="bi bi-trash me-1"></i>Delete
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
</div>

<!-- Custom Styling -->
<style>
    .btn-gradient {
        background: linear-gradient(90deg, #28a745, #20c997);
        border: none;
        transition: all 0.2s ease;
    }

        .btn-gradient:hover {
            transform: translateY(-1px);
            background: linear-gradient(90deg, #218838, #17a589);
        }

    .card {
        transition: all 0.2s ease-in-out;
    }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08);
        }

    thead tr th {
        background-color: #eafaf1 !important;
        font-weight: 600;
        border-bottom: 2px solid #d9f2e3 !important;
    }

    tbody tr.announcement-row:hover {
        background-color: #f8fdf9;
        transform: translateX(4px);
        transition: all 0.2s ease;
    }

    .btn-outline-success:hover {
        background-color: #28a745 !important;
        color: #fff !important;
    }

    .btn-outline-danger:hover {
        background-color: #dc3545 !important;
        color: #fff !important;
    }

    input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(30%) sepia(100%) saturate(300%) hue-rotate(90deg);
    }
</style>
